% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Analyse Factorielle Exploratoire (AFE)},
  pdfauthor={Manal Derghal},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Analyse Factorielle Exploratoire (AFE)}
\author{Manal Derghal}
\date{2025-09-05}

\begin{document}
\maketitle

\section{Pr√©paration de l'environnement de
travail}\label{pruxe9paration-de-lenvironnement-de-travail}

Ce bloc de code permet de s'assurer que tous les packages R n√©cessaires
√† l'analyse sont install√©s. Il v√©rifie leur pr√©sence et les installe si
besoin, en prenant en compte la possibilit√© d'utiliser un d√©p√¥t de
packages sp√©cifique √† EDF.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{required\_packages }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"polycor"}\NormalTok{,}\StringTok{"psych"}\NormalTok{,}\StringTok{"haven"}\NormalTok{,}\StringTok{"qgraph"}\NormalTok{,}\StringTok{"EGAnet"}\NormalTok{,}\StringTok{"Amelia"}\NormalTok{,}\StringTok{"rgl"}\NormalTok{)}
\CommentTok{\# Fonction pour v√©rifier si un package est install√©}
\NormalTok{is\_package\_installed }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(package\_name) \{}
  \FunctionTok{return}\NormalTok{(package\_name }\SpecialCharTok{\%in\%} \FunctionTok{installed.packages}\NormalTok{()[, }\StringTok{"Package"}\NormalTok{])}
\NormalTok{\}}

\CommentTok{\# D√©finir un d√©p√¥t personnalis√© EDF si n√©cessaire}
\NormalTok{edf\_repo }\OtherTok{\textless{}{-}} \StringTok{"https://si{-}devops{-}mirror.edf.fr/repository/cran.r{-}project.org/"}
\CommentTok{\# Demander √† l\textquotesingle{}utilisateur s\textquotesingle{}il utilise un PC EDF}
\NormalTok{use\_edf\_repo }\OtherTok{\textless{}{-}} \FunctionTok{tolower}\NormalTok{(}\FunctionTok{readline}\NormalTok{(}\StringTok{"üíª Es{-}tu sur un PC EDF ? (oui/non) : "}\NormalTok{)) }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"oui"}\NormalTok{, }\StringTok{"o"}\NormalTok{, }\StringTok{"yes"}\NormalTok{, }\StringTok{"y"}\NormalTok{)}

\CommentTok{\# Installation des packages}
\ControlFlowTok{for}\NormalTok{ (pkg }\ControlFlowTok{in}\NormalTok{ required\_packages) \{}
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is\_package\_installed}\NormalTok{(pkg)) \{}
    

    \FunctionTok{message}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"üîÑ Installation de"}\NormalTok{, pkg, }\StringTok{"..."}\NormalTok{))}
    \ControlFlowTok{if}\NormalTok{ (use\_edf\_repo) \{}
      \FunctionTok{install.packages}\NormalTok{(pkg, }\AttributeTok{repos =}\NormalTok{ edf\_repo)}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
      \FunctionTok{install.packages}\NormalTok{(pkg)}
\NormalTok{    \}}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{message}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"‚úì"}\NormalTok{, pkg, }\StringTok{"d√©j√† install√©."}\NormalTok{))}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## ‚úì polycor d√©j√† install√©.
\end{verbatim}

\begin{verbatim}
## ‚úì psych d√©j√† install√©.
\end{verbatim}

\begin{verbatim}
## ‚úì haven d√©j√† install√©.
\end{verbatim}

\begin{verbatim}
## ‚úì qgraph d√©j√† install√©.
\end{verbatim}

\begin{verbatim}
## ‚úì EGAnet d√©j√† install√©.
\end{verbatim}

\begin{verbatim}
## ‚úì Amelia d√©j√† install√©.
\end{verbatim}

\begin{verbatim}
## ‚úì rgl d√©j√† install√©.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{üéâ Tous les packages sont install√©s ou d√©j√† pr√©sents. }\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Chargement des librairies}\label{chargement-des-librairies}

Ce code charge les librairies R n√©cessaires pour l'ex√©cution des scripts
suivants, en supprimant les messages de d√©marrage pour une sortie plus
propre.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(polycor)}
\FunctionTok{library}\NormalTok{(psych)}
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(qgraph)}
\FunctionTok{library}\NormalTok{(Amelia)}
\FunctionTok{library}\NormalTok{(EGAnet)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

\section{Pr√©paration et nettoyage initial des
donn√©es}\label{pruxe9paration-et-nettoyage-initial-des-donnuxe9es}

Ce bloc de code charge les donn√©es depuis un fichier CSV, effectue un
tri al√©atoire, puis conserve uniquement le bilan le plus r√©cent pour
chaque individu (cle). Il supprime √©galement les lignes contenant des
valeurs incorrectes pour la variable pcs.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Chargement des donn√©es depuis le fichier CSV.}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"visites\_6.csv"}\NormalTok{, }\AttributeTok{sep=}\StringTok{";"}\NormalTok{)}

\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(df)}

\NormalTok{colonnes }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}cle\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}date\_bilan\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}sexe2\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}age3\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pcs1\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_plein\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_j\_normal\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_j\_coupure\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_j\_decale\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_j\_alterne\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_j\_nuit\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_j\_deplace\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}ct\_c\_depasse\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_c\_repas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_c\_rigueur\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_c\_pression\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_a\_apprend\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_a\_varie\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_a\_libre\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_a\_coop\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_a\_reconnu\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_ex\_psy\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}s\_anxiete\_plainte\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}s\_fatigue\_plainte\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}s\_sommeil\_plainte\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_a\_desapprouve\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_a\_emploi\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_a\_concilier\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}ct\_a\_qualite\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}qc\_ieg\_perspective\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}qc\_ieg\_sens\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}qc\_ieg\_objectif\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}qc\_ieg\_suggestion\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}qc\_ieg\_ambiance\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ct\_c\_aba\_neg2\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}f\_1an2\textquotesingle{}}
\NormalTok{)}

\CommentTok{\# S√©lection des colonnes}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[, colonnes]}

\CommentTok{\# Renommage des colonnes}
\NormalTok{nouvelles\_colonnes }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}cle\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}date\_bilan\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}sexe\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}age\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pcs\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}tps\_plein\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}jour\_norm\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}jour\_coup\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}jour\_decale\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}jour\_alterne\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}travail\_nuit\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}deplac\_pro\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}depasse\_horaire\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}saut\_repas\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}trop\_vite\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pression\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}apprend\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}varie\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}libre\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}cooperation\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}reconnu\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}psy\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}s\_anxiete\_plainte\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}s\_fatigue\_plainte\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}s\_sommeil\_plainte\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}desapprouve\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}peur\_emploi\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}concilier\_vie\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}qualite\_travail\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}perspective\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}sens\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}objectif\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}suggestion\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}ambiance\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}taches\_diff\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}pas\_formation\textquotesingle{}}
\NormalTok{)}

\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{setNames}\NormalTok{(df, nouvelles\_colonnes)}


\CommentTok{\# Trie de fa√ßon al√©atoire les lignes du data frame \textquotesingle{}df\textquotesingle{}}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{sample\_n}\NormalTok{(}\FunctionTok{n}\NormalTok{())}

\CommentTok{\# Tri par date de bilan pour conserver le plus r√©cent pour chaque \textquotesingle{}cle\textquotesingle{}.}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(date\_bilan)) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{distinct}\NormalTok{(cle, }\AttributeTok{.keep\_all =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Suppression des lignes avec des valeurs de \textquotesingle{}pcs\textquotesingle{} incorrectes (1 et 2).}
\NormalTok{df }\OtherTok{\textless{}{-}}\NormalTok{ df[}\SpecialCharTok{!}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{pcs }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)),]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 61284    36
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df[, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   date_bilan sexe age pcs tps_plein jour_norm jour_coup jour_decale
## 1 2025-02-13    2   2   3         1        NA         0           0
## 2 2025-02-13    2   2   3         1         1         0           0
## 3 2025-02-13    1   1   4         1         1         0           0
## 4 2025-02-13    1   1   4         1         1         1           0
## 5 2025-02-13    2   1   4         0         1         0           0
## 6 2025-02-13    1   3   4         1         1         0           0
##   jour_alterne travail_nuit deplac_pro depasse_horaire saut_repas trop_vite
## 1            0            0          0               1          1         1
## 2            0            0          0               2          1         2
## 3            0            0          1               1          1         1
## 4            0            0          1               2          1         1
## 5            0            0          0               1          0         1
## 6            0            0          1               1          1         1
##   pression apprend varie libre cooperation reconnu psy s_anxiete_plainte
## 1        8       3     3     2           3       3   0                NA
## 2        8       2     1     3           2       2   0                NA
## 3        7       2     2     2           2       2   0                 0
## 4        5       3     3     3           3       3   1                 0
## 5        7       2     2     2           2       1   1                NA
## 6        6       2     2     2           3       1   0                 0
##   s_fatigue_plainte s_sommeil_plainte desapprouve peur_emploi concilier_vie
## 1                NA                NA           1           0             2
## 2                NA                NA           0           0             2
## 3                 0                 0           1           0             2
## 4                 0                 0           1           1             2
## 5                NA                NA           2           0             2
## 6                 0                 0           2           0             2
##   qualite_travail perspective sens objectif suggestion ambiance taches_diff
## 1               3          NA   NA       NA         NA       NA           1
## 2               2           2    1        3          3        7           1
## 3               2           2    2        2          2        8           1
## 4               3           2    2        2          2        8           0
## 5               1          NA   NA       NA         NA       NA           1
## 6               2           1    2        2          2        5           0
##   pas_formation
## 1             1
## 2             0
## 3             0
## 4             0
## 5            NA
## 6             0
\end{verbatim}

\section{S√©lection des items pour l'analyse
factorielle}\label{suxe9lection-des-items-pour-lanalyse-factorielle}

Ici, nous d√©finissons et cr√©ons un nouveau jeu de donn√©es (df\_items)
qui contient uniquement les variables pertinentes pour l'analyse
factorielle, en excluant les variables d√©mographiques et certaines
plaintes.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# D√©finit les items (colonnes) √† exclure de l\textquotesingle{}analyse.}
\NormalTok{items\_to\_drop }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}date\_bilan\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}age\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}sexe\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}pcs\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}s\_anxiete\_plainte\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}s\_fatigue\_plainte\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}s\_sommeil\_plainte\textquotesingle{}}
\NormalTok{)}

\CommentTok{\# Cr√©e un nouveau data frame avec uniquement les items √† analyser.}
\NormalTok{df\_items }\OtherTok{\textless{}{-}}\NormalTok{ df[, }\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(df) }\SpecialCharTok{\%in\%}\NormalTok{ items\_to\_drop), drop }\OtherTok{=} \ConstantTok{FALSE}\NormalTok{]}

\CommentTok{\# Affiche le nombre d\textquotesingle{}items s√©lectionn√©s.}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"S√©lection de"}\NormalTok{, }\FunctionTok{length}\NormalTok{(df\_items), }\StringTok{"items pour l\textquotesingle{}analyse.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## S√©lection de 29 items pour l'analyse.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df\_items[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   tps_plein jour_norm jour_coup jour_decale jour_alterne travail_nuit
## 1         1        NA         0           0            0            0
## 2         1         1         0           0            0            0
## 3         1         1         0           0            0            0
## 4         1         1         1           0            0            0
## 5         0         1         0           0            0            0
## 6         1         1         0           0            0            0
##   deplac_pro depasse_horaire saut_repas trop_vite pression apprend varie libre
## 1          0               1          1         1        8       3     3     2
## 2          0               2          1         2        8       2     1     3
## 3          1               1          1         1        7       2     2     2
## 4          1               2          1         1        5       3     3     3
## 5          0               1          0         1        7       2     2     2
## 6          1               1          1         1        6       2     2     2
##   cooperation reconnu psy desapprouve peur_emploi concilier_vie qualite_travail
## 1           3       3   0           1           0             2               3
## 2           2       2   0           0           0             2               2
## 3           2       2   0           1           0             2               2
## 4           3       3   1           1           1             2               3
## 5           2       1   1           2           0             2               1
## 6           3       1   0           2           0             2               2
##   perspective sens objectif suggestion ambiance taches_diff pas_formation
## 1          NA   NA       NA         NA       NA           1             1
## 2           2    1        3          3        7           1             0
## 3           2    2        2          2        8           1             0
## 4           2    2        2          2        8           0             0
## 5          NA   NA       NA         NA       NA           1            NA
## 6           1    2        2          2        5           0             0
\end{verbatim}

\section{Recodage et transformation des
variables}\label{recodage-et-transformation-des-variables}

Ce bloc de code effectue des transformations importantes sur les
donn√©es, notamment l'inversion de l'√©chelle de certaines variables
ordinales et la discr√©tisation de variables continues en utilisant des
quantiles.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Variables ordinales 0{-}1 √† inverser (0{-}\textgreater{}1, 1{-}\textgreater{}0)}
\CommentTok{\# D√©finit les variables dont les scores de 0 et 1 doivent √™tre invers√©s.}
\NormalTok{variables\_ordinales\_0\_1\_a\_inverser }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}tps\_plein\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}jour\_norm\textquotesingle{}}\NormalTok{)}

\CommentTok{\# Applique l\textquotesingle{}inversion √† chaque colonne de la liste.}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in}\NormalTok{ variables\_ordinales\_0\_1\_a\_inverser) \{}
\NormalTok{  df[[col]] }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ df[[col]]}
\NormalTok{\}}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Variables ordinales 0{-}1 invers√©es :"}\NormalTok{, }\FunctionTok{paste}\NormalTok{(variables\_ordinales\_0\_1\_a\_inverser, }\AttributeTok{collapse =} \StringTok{", "}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Variables ordinales 0-1 invers√©es : tps_plein, jour_norm
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Variables ordinales 0{-}3 √† inverser (0{-}\textgreater{}3, 1{-}\textgreater{}2, 2{-}\textgreater{}1, 3{-}\textgreater{}0)}
\CommentTok{\# D√©finit les variables dont les scores de 0 √† 3 doivent √™tre invers√©s.}
\NormalTok{variables\_ordinales\_0\_3\_a\_inverser }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
    \StringTok{\textquotesingle{}apprend\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}varie\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}libre\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}cooperation\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}reconnu\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}concilier\_vie\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}qualite\_travail\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}perspective\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}sens\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}objectif\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}suggestion\textquotesingle{}}
\NormalTok{)}

\CommentTok{\# Applique l\textquotesingle{}inversion √† chaque colonne de la liste.}
\ControlFlowTok{for}\NormalTok{ (col }\ControlFlowTok{in}\NormalTok{ variables\_ordinales\_0\_3\_a\_inverser) \{}
\NormalTok{  df[[col]] }\OtherTok{\textless{}{-}} \DecValTok{3} \SpecialCharTok{{-}}\NormalTok{ df[[col]]}
\NormalTok{\}}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Variables ordinales 0{-}3 invers√©es :"}\NormalTok{, }\FunctionTok{paste}\NormalTok{(variables\_ordinales\_0\_3\_a\_inverser, }\AttributeTok{collapse =} \StringTok{", "}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Variables ordinales 0-3 invers√©es : apprend, varie, libre, cooperation, reconnu, concilier_vie, qualite_travail, perspective, sens, objectif, suggestion
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Transformation de \textquotesingle{}ct\_c\_pression\textquotesingle{} en variable ordinale.}
\CommentTok{\# Calcule les quantiles pour d√©finir les points de coupe.}
\NormalTok{quantile\_breaks\_pression }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(df\_items}\SpecialCharTok{$}\NormalTok{pression,}
                                     \AttributeTok{probs =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.75}\NormalTok{, }\DecValTok{1}\NormalTok{),}
                                     \AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{unique\_breaks\_pression }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(quantile\_breaks\_pression)}

\CommentTok{\# Affiche les points de coupe.}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Points de coupe pour \textquotesingle{}pression\textquotesingle{} bas√©s sur les quantiles (Min, Q1, Med, Q3, Max) :}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Points de coupe pour 'pression' bas√©s sur les quantiles (Min, Q1, Med, Q3, Max) :
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(unique\_breaks\_pression)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  0  3  5  7 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Discr√©tise la variable \textquotesingle{}pression\textquotesingle{} en utilisant les quantiles.}
\NormalTok{df\_items}\SpecialCharTok{$}\NormalTok{pression }\OtherTok{\textless{}{-}} \FunctionTok{cut}\NormalTok{(df\_items}\SpecialCharTok{$}\NormalTok{pression,}
                              \AttributeTok{breaks =}\NormalTok{ unique\_breaks\_pression,}
                              \AttributeTok{include.lowest =} \ConstantTok{TRUE}\NormalTok{,}
                              \AttributeTok{labels =} \ConstantTok{FALSE}\NormalTok{)}


\CommentTok{\# Transformation de \textquotesingle{}qc\_ieg\_ambiance\textquotesingle{} en variable ordinale.}
\CommentTok{\# Calcule les quantiles pour d√©finir les points de coupe.}
\NormalTok{quantile\_breaks\_ambiance }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(df\_items}\SpecialCharTok{$}\NormalTok{ambiance,}
                                     \AttributeTok{probs =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\FloatTok{0.25}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\FloatTok{0.75}\NormalTok{, }\DecValTok{1}\NormalTok{),}
                                     \AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{unique\_breaks\_ambiance }\OtherTok{\textless{}{-}} \FunctionTok{unique}\NormalTok{(quantile\_breaks\_ambiance)}

\CommentTok{\# Affiche les points de coupe.}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Points de coupe pour \textquotesingle{}ambiance\textquotesingle{} bas√©s sur les quantiles (Min, Q1, Med, Q3, Max) :}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Points de coupe pour 'ambiance' bas√©s sur les quantiles (Min, Q1, Med, Q3, Max) :
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(unique\_breaks\_ambiance)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  0  6  7  8 10
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Discr√©tise la variable \textquotesingle{}ambiance\textquotesingle{} en utilisant les quantiles.}
\NormalTok{df\_items}\SpecialCharTok{$}\NormalTok{ambiance }\OtherTok{\textless{}{-}} \FunctionTok{cut}\NormalTok{(df\_items}\SpecialCharTok{$}\NormalTok{ambiance,}
                                \AttributeTok{breaks =}\NormalTok{ unique\_breaks\_ambiance,}
                                \AttributeTok{include.lowest =} \ConstantTok{TRUE}\NormalTok{,}
                                \AttributeTok{labels =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Comparaison des corr√©lations de Pearson et
Polychoriques}\label{comparaison-des-corruxe9lations-de-pearson-et-polychoriques}

Ce code compare les matrices de corr√©lation de Pearson (inadapt√©e pour
les donn√©es ordinales) et polychorique (plus appropri√©e) afin de montrer
l'importance d'utiliser la bonne m√©thode.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# S√©lectionne les 10 premi√®res variables pour l\textquotesingle{}analyse.}
\NormalTok{features }\OtherTok{=}\NormalTok{ df\_items[}\DecValTok{10}\SpecialCharTok{:}\DecValTok{20}\NormalTok{]}
\NormalTok{features }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(features)}

\CommentTok{\# Calcule la corr√©lation de Pearson, qui traite les donn√©es comme continues.}
\NormalTok{pear\_cor }\OtherTok{=} \FunctionTok{cor}\NormalTok{(features)}

\CommentTok{\# Trace la matrice de corr√©lation de Pearson.}
\FunctionTok{cor.plot}\NormalTok{(pear\_cor, }\AttributeTok{numbers=}\NormalTok{T, }\AttributeTok{upper=}\ConstantTok{FALSE}\NormalTok{,  }\AttributeTok{main =} \StringTok{"Pearson Correlation"}\NormalTok{, }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-8-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calcule la corr√©lation polychorique, mieux adapt√©e aux donn√©es ordinales.}
\NormalTok{poly\_cor }\OtherTok{=} \FunctionTok{auto.correlate}\NormalTok{(features)}

\CommentTok{\# Trace la matrice de corr√©lation polychorique.}
\FunctionTok{cor.plot}\NormalTok{(poly\_cor, }\AttributeTok{numbers=}\NormalTok{T, }\AttributeTok{upper=}\ConstantTok{FALSE}\NormalTok{, }\AttributeTok{main =} \StringTok{"Polychoric Correlation"}\NormalTok{, }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-8-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calcule la diff√©rence absolue entre les deux matrices pour montrer la distorsion.}
\NormalTok{diff\_abs }\OtherTok{=} \FunctionTok{abs}\NormalTok{(poly\_cor }\SpecialCharTok{{-}}\NormalTok{ pear\_cor)}

\FunctionTok{png}\NormalTok{(}\StringTok{"Images/polychoric\_vs\_pearson.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{2000}\NormalTok{, }\AttributeTok{height =} \DecValTok{1500}\NormalTok{, }\AttributeTok{res =} \DecValTok{300}\NormalTok{, }\AttributeTok{units =} \StringTok{"px"}\NormalTok{)}
\CommentTok{\# Trace la matrice de la diff√©rence pour visualiser l\textquotesingle{}ampleur de l\textquotesingle{}√©cart.}
\FunctionTok{cor.plot}\NormalTok{(diff\_abs, }\AttributeTok{numbers =}\NormalTok{ T, }\AttributeTok{upper =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{diag =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{main =} \StringTok{"Valeur absolue de la diff√©rence"}\NormalTok{)}
\FunctionTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor.plot}\NormalTok{(diff\_abs, }\AttributeTok{numbers =}\NormalTok{ T, }\AttributeTok{upper =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{diag =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{main =} \StringTok{"Valeur absolue de la diff√©rence"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-8-3.pdf}

\section{Visualisation des valeurs
manquantes}\label{visualisation-des-valeurs-manquantes}

Ce bloc de code g√©n√®re une carte des valeurs manquantes (missmap) pour
le jeu de donn√©es final, ce qui permet de visualiser la distribution des
NA.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# D√©marre l\textquotesingle{}enregistrement d\textquotesingle{}un graphique dans un fichier PNG.}
\FunctionTok{png}\NormalTok{(}\StringTok{"Images/missingnessmap.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{2100}\NormalTok{, }\AttributeTok{height =} \DecValTok{1500}\NormalTok{, }\AttributeTok{res =} \DecValTok{300}\NormalTok{)}

\CommentTok{\# Affiche le titre "Missing map:".}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Missing map:}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Missing map:
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Cr√©e et affiche la carte des donn√©es manquantes pour le data frame \textquotesingle{}df\_items\textquotesingle{}.}
\FunctionTok{missmap}\NormalTok{(df\_items)}

\CommentTok{\# Ferme le p√©riph√©rique graphique et enregistre le fichier.}
\FunctionTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{missmap}\NormalTok{(df\_items)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-9-1.pdf}

\section{Analyse visuelle des corr√©lations :
qgraph}\label{analyse-visuelle-des-corruxe9lations-qgraph}

Le qgraph permet de visualiser la structure de corr√©lation entre les
variables, en mettant en √©vidence les liens forts et faibles. Ce bloc de
code g√©n√®re ce graphique et affiche √©galement les corr√©lations les plus
fortes (\textgreater{} 0.8).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Suppression des lignes NA}
\NormalTok{df\_items }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(df\_items)}

\CommentTok{\#enlever la cle}
\NormalTok{df\_items2 }\OtherTok{\textless{}{-}}\NormalTok{ df\_items[,}\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{)]}

\CommentTok{\# Calcule la matrice de corr√©lation polychorique pour les variables.}
\NormalTok{poly\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{auto.correlate}\NormalTok{(df\_items2)}

\CommentTok{\# D√©marre l\textquotesingle{}enregistrement d\textquotesingle{}un graphique dans un fichier PNG.}
\FunctionTok{png}\NormalTok{(}\StringTok{"Images/qgraph.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{800}\NormalTok{, }\AttributeTok{height =} \DecValTok{600}\NormalTok{, }\AttributeTok{res =} \DecValTok{100}\NormalTok{)}

\CommentTok{\# Cr√©e et customise le graphique de corr√©lation (qgraph).}
\CommentTok{\# Les param√®tres ajustent l\textquotesingle{}affichage des ar√™tes (corr√©lations), des couleurs,}
\CommentTok{\# et la taille des labels et des n≈ìuds.}
\FunctionTok{qgraph}\NormalTok{(poly\_matrix,}
       \AttributeTok{cut =}\NormalTok{ .}\DecValTok{30}\NormalTok{,}
       \AttributeTok{minimum =}\NormalTok{ .}\DecValTok{30}\NormalTok{,}
       \AttributeTok{details =} \ConstantTok{TRUE}\NormalTok{,}
       \AttributeTok{labels =} \FunctionTok{names}\NormalTok{(df\_items2),}
       \AttributeTok{label.font =} \DecValTok{2}\NormalTok{,}
       \AttributeTok{label.cex =} \FloatTok{1.5}\NormalTok{,}
       \AttributeTok{vsize =} \DecValTok{7}
\NormalTok{)}

\CommentTok{\# Ferme le p√©riph√©rique graphique et enregistre le fichier.}
\FunctionTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# D√©finit un seuil pour l\textquotesingle{}affichage des corr√©lations fortes.}
\NormalTok{correlation\_threshold }\OtherTok{\textless{}{-}} \FloatTok{0.8}

\FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{{-}{-}{-} Corr√©lations Polychoriques \textgreater{}"}\NormalTok{, correlation\_threshold, }\StringTok{" (valeur absolue) {-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## --- Corr√©lations Polychoriques > 0.8  (valeur absolue) ---
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Parcours la matrice de corr√©lation pour trouver et afficher les paires}
\CommentTok{\# de variables dont la corr√©lation (en valeur absolue) d√©passe le seuil.}
\NormalTok{var\_names }\OtherTok{\textless{}{-}} \FunctionTok{colnames}\NormalTok{(poly\_matrix)}
\NormalTok{n\_vars }\OtherTok{\textless{}{-}} \FunctionTok{ncol}\NormalTok{(poly\_matrix)}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(n\_vars }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)) \{}
  \ControlFlowTok{for}\NormalTok{ (j }\ControlFlowTok{in}\NormalTok{ (i }\SpecialCharTok{+} \DecValTok{1}\NormalTok{)}\SpecialCharTok{:}\NormalTok{n\_vars) \{}
\NormalTok{    correlation\_value }\OtherTok{\textless{}{-}}\NormalTok{ poly\_matrix[i, j]}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{abs}\NormalTok{(correlation\_value) }\SpecialCharTok{\textgreater{}}\NormalTok{ correlation\_threshold) \{}
      \FunctionTok{cat}\NormalTok{(}\FunctionTok{sprintf}\NormalTok{(}\StringTok{"Corr√©lation entre \%s et \%s : \%.3f}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{,}
\NormalTok{                  var\_names[i], var\_names[j], correlation\_value))}
\NormalTok{    \}}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Corr√©lation entre jour_decale et jour_alterne : 0.874
## Corr√©lation entre jour_decale et travail_nuit : 0.852
## Corr√©lation entre jour_alterne et travail_nuit : 0.887
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qgraph}\NormalTok{(poly\_matrix,}
       \AttributeTok{cut =}\NormalTok{ .}\DecValTok{30}\NormalTok{,}
       \AttributeTok{minimum =}\NormalTok{ .}\DecValTok{30}\NormalTok{,}
       \AttributeTok{details =} \ConstantTok{TRUE}\NormalTok{,}
       \AttributeTok{labels =} \FunctionTok{names}\NormalTok{(df\_items2),}
       \AttributeTok{label.font =} \DecValTok{2}\NormalTok{,}
       \AttributeTok{label.cex =} \FloatTok{1.5}\NormalTok{,}
       \AttributeTok{vsize =} \DecValTok{7}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(df\_items)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 50652    29
\end{verbatim}

Suite √† l'inspection du qgraph, les variables travail\_nuit et
jour\_decale sont supprim√©es pour √©viter des probl√®mes de colin√©arit√©.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Suppression des colonnes \textquotesingle{}travail\_nuit\textquotesingle{} et \textquotesingle{}jour\_decale\textquotesingle{} car elles sont trop corr√©l√©es.}
\NormalTok{df\_items }\OtherTok{\textless{}{-}}\NormalTok{ df\_items[,}\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(df\_items) }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}travail\_nuit\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}jour\_decale\textquotesingle{}}\NormalTok{))]}
\end{Highlighting}
\end{Shaded}

\section{Nettoyage des donn√©es : variance et valeurs
manquantes}\label{nettoyage-des-donnuxe9es-variance-et-valeurs-manquantes}

Ce bloc de code d√©finit et ex√©cute une fonction pour nettoyer les
donn√©es en supprimant les variables qui ont une variance trop faible.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fonction pour nettoyer les donn√©es en fonction de la variance et des valeurs manquantes.}
\NormalTok{clean\_data }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df\_input) \{}
  
  \CommentTok{\# Affiche les variances des variables.}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Variance par variable :}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  variances }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(df\_input, var, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{sort}\NormalTok{(variances, }\AttributeTok{decreasing =} \ConstantTok{FALSE}\NormalTok{))}

  \CommentTok{\# Supprime les variables avec une variance faible (seuil : 0.15).}
\NormalTok{  low\_var\_threshold }\OtherTok{\textless{}{-}} \FloatTok{0.15}
\NormalTok{  low\_var\_items }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(variances[variances }\SpecialCharTok{\textless{}}\NormalTok{ low\_var\_threshold])}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(low\_var\_items) }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) \{}
\NormalTok{    df\_output }\OtherTok{\textless{}{-}}\NormalTok{ df\_input[, }\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(df\_input) }\SpecialCharTok{\%in\%}\NormalTok{ low\_var\_items)]}
    \FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Variables supprim√©es pour faible variance (\textless{}"}\NormalTok{, low\_var\_threshold, }\StringTok{"):"}\NormalTok{, }\FunctionTok{paste}\NormalTok{(low\_var\_items, }\AttributeTok{collapse=}\StringTok{", "}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{    df\_output }\OtherTok{\textless{}{-}}\NormalTok{ df\_input}
    \FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Aucune variable supprim√©e pour faible variance (\textless{}"}\NormalTok{, low\_var\_threshold, }\StringTok{").}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\NormalTok{  \}}
  \FunctionTok{return}\NormalTok{(df\_output)}
\NormalTok{\}}

\CommentTok{\# Cr√©ez une copie de votre data frame pour ne travailler que sur les colonnes √† nettoyer}
\NormalTok{df\_to\_clean }\OtherTok{\textless{}{-}}\NormalTok{ df\_items[, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Appliquez la fonction \textquotesingle{}clean\_data\textquotesingle{} √† cette copie}
\NormalTok{df\_cleaned }\OtherTok{\textless{}{-}} \FunctionTok{clean\_data}\NormalTok{(df\_to\_clean)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Variance par variable :
##       jour_coup       tps_plein       jour_norm    jour_alterne      deplac_pro 
##      0.06248344      0.06831927      0.08085287      0.13721377      0.14607646 
##             psy   pas_formation     taches_diff     peur_emploi qualite_travail 
##      0.18064207      0.19256933      0.24488021      0.31821390      0.39702462 
##   concilier_vie     cooperation         apprend        objectif     desapprouve 
##      0.42013959      0.43692144      0.46824183      0.47578769      0.47639117 
##           varie            sens         reconnu      suggestion           libre 
##      0.47676515      0.47875431      0.53967008      0.55760204      0.62487740 
##      saut_repas       trop_vite depasse_horaire     perspective        pression 
##      0.64188256      0.66208703      0.70832444      0.76352448      1.05813421 
##        ambiance 
##      1.24968513 
## Variables supprim√©es pour faible variance (< 0.15 ): tps_plein, jour_norm, jour_coup, jour_alterne, deplac_pro
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# data frame nettoy√© en ajoutant la colonne de cl√© (la premi√®re colonne)}
\NormalTok{df\_items }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(df\_items[, }\DecValTok{1}\NormalTok{], df\_cleaned)}
\FunctionTok{colnames}\NormalTok{(df\_items)[}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"cle"}
\end{Highlighting}
\end{Shaded}

\section{Suppression de variables
suppl√©mentaires}\label{suppression-de-variables-suppluxe9mentaires}

Certaines variables sont manuellement retir√©es car elles ne s'int√®grent
pas bien dans le mod√®le factoriel (communalit√©s basses / cross-loadings)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{items\_to\_drop }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{\textquotesingle{}pas\_formation\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}peur\_emploi\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}desapprouve\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}qualite\_travail\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}libre\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}concilier\_vie\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}objectif\textquotesingle{}}\NormalTok{,}
  \StringTok{\textquotesingle{}saut\_repas\textquotesingle{}}
\NormalTok{)}

\CommentTok{\# Cr√©e un nouveau data frame sans les variables exclues.}
\NormalTok{df\_items\_removed }\OtherTok{\textless{}{-}}\NormalTok{ df\_items[, }\SpecialCharTok{!}\NormalTok{(}\FunctionTok{names}\NormalTok{(df\_items) }\SpecialCharTok{\%in\%}\NormalTok{ items\_to\_drop), drop }\OtherTok{=} \ConstantTok{FALSE}\NormalTok{]}

\CommentTok{\# Affiche le nombre d\textquotesingle{}items restants.}
\FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"S√©lection de"}\NormalTok{, }\FunctionTok{length}\NormalTok{(df\_items\_removed)}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\StringTok{"items pour l\textquotesingle{}analyse.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## S√©lection de 13 items pour l'analyse.
\end{verbatim}

\section{Nouvel aper√ßu du qgraph apr√®s
nettoyage}\label{nouvel-aperuxe7u-du-qgraph-apruxe8s-nettoyage}

Apr√®s le nettoyage des variables, un nouveau qgraph est g√©n√©r√© pour
confirmer l'impact des suppressions sur la structure de corr√©lation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_items2 }\OtherTok{\textless{}{-}}\NormalTok{ df\_items\_removed[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}

\CommentTok{\# Calcule la matrice de corr√©lation polychorique pour les variables.}
\NormalTok{poly\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{auto.correlate}\NormalTok{(df\_items2)}

\CommentTok{\# D√©marre l\textquotesingle{}enregistrement d\textquotesingle{}un graphique dans un fichier PNG.}
\FunctionTok{png}\NormalTok{(}\StringTok{"Images/qgraph2.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{800}\NormalTok{, }\AttributeTok{height =} \DecValTok{600}\NormalTok{, }\AttributeTok{res =} \DecValTok{100}\NormalTok{)}

\CommentTok{\# Cr√©e et customise le graphique de corr√©lation (qgraph).}
\CommentTok{\# Les param√®tres ajustent l\textquotesingle{}affichage des ar√™tes (corr√©lations), des couleurs,}
\CommentTok{\# et la taille des labels et des n≈ìuds.}
\FunctionTok{qgraph}\NormalTok{(poly\_matrix,}
       \AttributeTok{cut =}\NormalTok{ .}\DecValTok{30}\NormalTok{,}
       \AttributeTok{minimum =}\NormalTok{ .}\DecValTok{30}\NormalTok{,}
       \AttributeTok{details =} \ConstantTok{TRUE}\NormalTok{,}
       \AttributeTok{posCOL =} \StringTok{"darkgreen"}\NormalTok{,}
       \AttributeTok{negCOL =} \StringTok{"red"}\NormalTok{,}
       \AttributeTok{labels =} \FunctionTok{names}\NormalTok{(df\_items2),}
       \AttributeTok{label.font =} \DecValTok{2}\NormalTok{,}
       \AttributeTok{label.cex =} \FloatTok{1.5}\NormalTok{,}
       \AttributeTok{vsize =} \DecValTok{7}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in qgraph(poly_matrix, cut = 0.3, minimum = 0.3, details = TRUE, : The
## following arguments are not documented and likely not arguments of qgraph and
## thus ignored: posCOL; negCOL
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Ferme le p√©riph√©rique graphique et enregistre le fichier.}
\FunctionTok{dev.off}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## pdf 
##   2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qgraph}\NormalTok{(poly\_matrix,}
       \AttributeTok{cut =}\NormalTok{ .}\DecValTok{30}\NormalTok{,}
       \AttributeTok{minimum =}\NormalTok{ .}\DecValTok{30}\NormalTok{,}
       \AttributeTok{details =} \ConstantTok{TRUE}\NormalTok{,}
       \AttributeTok{posCOL =} \StringTok{"darkgreen"}\NormalTok{,}
       \AttributeTok{negCOL =} \StringTok{"red"}\NormalTok{,}
       \AttributeTok{labels =} \FunctionTok{names}\NormalTok{(df\_items2),}
       \AttributeTok{label.font =} \DecValTok{2}\NormalTok{,}
       \AttributeTok{label.cex =} \FloatTok{1.5}\NormalTok{,}
       \AttributeTok{vsize =} \DecValTok{7}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in qgraph(poly_matrix, cut = 0.3, minimum = 0.3, details = TRUE, : The
## following arguments are not documented and likely not arguments of qgraph and
## thus ignored: posCOL; negCOL
\end{verbatim}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-15-1.pdf}

\section{√âvaluation de la faisabilit√© de
l'AFE}\label{uxe9valuation-de-la-faisabilituxe9-de-lafe}

Avant de lancer l'analyse factorielle, il faut v√©rifier si les donn√©es
sont adapt√©es. Ce bloc de code effectue les tests de KMO et de
sph√©ricit√© de Bartlett, et affiche le d√©terminant de la matrice de
corr√©lation.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fonction pour √©valuer la faisabilit√© d\textquotesingle{}une analyse factorielle exploratoire (AFE).}
\NormalTok{perform\_efa\_feasibility }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df\_input) \{}

  \CommentTok{\# Calcule la matrice de corr√©lations polychoriques entre les variables.}
\NormalTok{  poly\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{auto.correlate}\NormalTok{(df\_input)}

  \CommentTok{\# Effectue le test KMO pour mesurer l\textquotesingle{}ad√©quation de l\textquotesingle{}√©chantillonnage pour l\textquotesingle{}AFE.}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Test KMO :}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  kmo\_result }\OtherTok{\textless{}{-}} \FunctionTok{KMO}\NormalTok{(poly\_matrix)}
  \FunctionTok{print}\NormalTok{(kmo\_result)}
  \ControlFlowTok{if}\NormalTok{ (kmo\_result}\SpecialCharTok{$}\NormalTok{MSA }\SpecialCharTok{\textgreater{}=} \FloatTok{0.7}\NormalTok{) \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{" KMO global \textgreater{} 0.7, l\textquotesingle{}ad√©quation est bonne.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (kmo\_result}\SpecialCharTok{$}\NormalTok{MSA }\SpecialCharTok{\textgreater{}=} \FloatTok{0.6}\NormalTok{) \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{" KMO global entre 0.6 et 0.7, l\textquotesingle{}ad√©quation est acceptable.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{warning}\NormalTok{(}\StringTok{"KMO global \textless{} 0.6, la faisabilit√© de l\textquotesingle{}AFE est discutable."}\NormalTok{)}
\NormalTok{  \}}

  \CommentTok{\# Effectue le test de sph√©ricit√© de Bartlett pour v√©rifier si les variables sont corr√©l√©es.}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Test de Bartlett :}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  n\_obs }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(df\_input)}
\NormalTok{  bartlett\_result }\OtherTok{\textless{}{-}} \FunctionTok{cortest.bartlett}\NormalTok{(poly\_matrix, }\AttributeTok{n =}\NormalTok{ n\_obs)}
  \FunctionTok{print}\NormalTok{(bartlett\_result)}
  \ControlFlowTok{if}\NormalTok{ (bartlett\_result}\SpecialCharTok{$}\NormalTok{p.value }\SpecialCharTok{\textless{}} \FloatTok{0.05}\NormalTok{) \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{"Test de Bartlett significatif (p \textless{} 0.05), les donn√©es sont corr√©l√©es.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{warning}\NormalTok{(}\StringTok{"Test de Bartlett non significatif (p \textgreater{}= 0.05), les variables ne semblent pas assez corr√©l√©es pour une AFE."}\NormalTok{)}
\NormalTok{  \}}

  \CommentTok{\# Affiche le d√©terminant de la matrice de corr√©lation}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{D√©terminant : }\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{print}\NormalTok{(}\FunctionTok{det}\NormalTok{(poly\_matrix))}

  \FunctionTok{return}\NormalTok{(poly\_matrix)}
\NormalTok{\}}

\NormalTok{poly\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{perform\_efa\_feasibility}\NormalTok{(df\_items2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Test KMO :
## Kaiser-Meyer-Olkin factor adequacy
## Call: KMO(r = poly_matrix)
## Overall MSA =  0.89
## MSA for each item = 
## depasse_horaire       trop_vite        pression         apprend           varie 
##            0.84            0.85            0.86            0.84            0.83 
##     cooperation         reconnu             psy     perspective            sens 
##            0.93            0.93            0.91            0.92            0.90 
##      suggestion        ambiance     taches_diff 
##            0.92            0.93            0.85 
##  KMO global > 0.7, l'ad√©quation est bonne.
## 
## Test de Bartlett :
## $chisq
## [1] 288741.6
## 
## $p.value
## [1] 0
## 
## $df
## [1] 78
## 
## Test de Bartlett significatif (p < 0.05), les donn√©es sont corr√©l√©es.
## 
## D√©terminant : 
## [1] 0.003341982
\end{verbatim}

\section{D√©termination du nombre de
facteurs}\label{duxe9termination-du-nombre-de-facteurs}

Cette √©tape utilise le Scree Plot (pour identifier le ``coude'') .

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fonction pour d√©terminer le nombre de facteurs √† retenir pour l\textquotesingle{}AFE.}
\NormalTok{determine\_n\_factors }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(poly\_matrix) \{}
  
  \CommentTok{\# D√©marre l\textquotesingle{}enregistrement du Scree Plot dans un fichier PNG.}
\NormalTok{  output\_filename\_scree\_parallel }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"images/scree\_analysis"}\NormalTok{, }\StringTok{".png"}\NormalTok{)}
  \FunctionTok{png}\NormalTok{(output\_filename\_scree\_parallel, }\AttributeTok{width =} \DecValTok{2000}\NormalTok{, }\AttributeTok{height =} \DecValTok{1500}\NormalTok{, }\AttributeTok{res =} \DecValTok{300}\NormalTok{, }\AttributeTok{units =} \StringTok{"px"}\NormalTok{)}
  
  \CommentTok{\# G√©n√®re un Scree Plot pour visualiser les valeurs propres et trouver le "coude".}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"G√©n√©ration du Scree Plot (bas√© sur la matrice polychorique)...}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{scree}\NormalTok{(poly\_matrix, }\AttributeTok{factors =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{pc =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{hline =} \StringTok{"{-}1"}\NormalTok{, }\AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\StringTok{""}\NormalTok{))}
  
  \CommentTok{\# Ferme le p√©riph√©rique graphique et enregistre le fichier.}
  \FunctionTok{dev.off}\NormalTok{()}
  
  \FunctionTok{scree}\NormalTok{(poly\_matrix, }\AttributeTok{factors =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{pc =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{hline =} \StringTok{"{-}1"}\NormalTok{, }\AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\StringTok{""}\NormalTok{))}

\NormalTok{\}}

\FunctionTok{determine\_n\_factors}\NormalTok{(poly\_matrix)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## G√©n√©ration du Scree Plot (bas√© sur la matrice polychorique)...
\end{verbatim}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-17-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(df\_items2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   depasse_horaire trop_vite pression apprend varie cooperation reconnu psy
## 2               2         2        4       2     1           2       2   0
## 3               1         1        3       2     2           2       2   0
## 4               2         1        2       3     3           3       3   1
## 6               1         1        3       2     2           3       1   0
## 7               3         1        4       2     3           2       3   0
## 9               2         1        4       2     1           2       1   1
##   perspective sens suggestion ambiance taches_diff
## 2           2    1          3        2           1
## 3           2    2          2        3           1
## 4           2    2          2        3           0
## 6           1    2          2        1           0
## 7           3    2          3        3           1
## 9           2    1          1        1           0
\end{verbatim}

\section{Ex√©cution de l'Analyse Factorielle Exploratoire
(AFE)}\label{exuxe9cution-de-lanalyse-factorielle-exploratoire-afe}

Ce bloc de code ex√©cute l'AFE en utilisant la matrice de corr√©lation
polychorique. Il utilise la m√©thode d'extraction pa (Principle Axis
Factoring) et une rotation oblique promax, qui est appropri√©e lorsque
l'on s'attend √† ce que les facteurs soient corr√©l√©s. Il g√©n√®re aussi des
graphiques des r√©sidus et des diagrammes de facteurs.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fonction pour ex√©cuter l\textquotesingle{}Analyse Factorielle Exploratoire (AFE).}
\NormalTok{perform\_efa }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(poly\_matrix, df\_raw\_data, n\_obs, n\_factors) \{}

  \CommentTok{\# Ex√©cute l\textquotesingle{}AFE en utilisant la matrice de corr√©lation polychorique.}
  \CommentTok{\# Les param√®tres sp√©cifient le nombre de facteurs, la m√©thode d\textquotesingle{}extraction (pa)}
  \CommentTok{\# et la rotation oblique (promax).}
\NormalTok{  efa\_model }\OtherTok{\textless{}{-}} \FunctionTok{fa}\NormalTok{(}
    \AttributeTok{r =}\NormalTok{ poly\_matrix,}
    \AttributeTok{nfactors =}\NormalTok{ n\_factors,}
    \AttributeTok{n.obs =}\NormalTok{ n\_obs,}
    \AttributeTok{rotate =} \StringTok{"varimax"}\NormalTok{,}
    \AttributeTok{fm =} \StringTok{"pa"}\NormalTok{,}
    \AttributeTok{residuals =}\NormalTok{ T,}
    \AttributeTok{SMC=}\NormalTok{T,}
    \AttributeTok{warnings=}\NormalTok{T}
\NormalTok{    )}

  \CommentTok{\# Affiche les saturations (loadings) des variables sur les facteurs.}
  \FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"R√©sultats de l\textquotesingle{}AFE :}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
  \FunctionTok{print.psych}\NormalTok{(efa\_model, }\AttributeTok{cut =} \FloatTok{0.3}\NormalTok{, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}

  \CommentTok{\# Affiche la matrice de corr√©lation entre les facteurs (Phi matrix).}
  \CommentTok{\# Cela n\textquotesingle{}est pertinent que pour une rotation oblique.}
  \FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Corr√©lations entre les facteurs (Phi matrix):}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
  \ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(efa\_model}\SpecialCharTok{$}\NormalTok{Phi)) \{}
    \FunctionTok{print}\NormalTok{(}\FunctionTok{round}\NormalTok{(efa\_model}\SpecialCharTok{$}\NormalTok{Phi, }\DecValTok{2}\NormalTok{))}
\NormalTok{  \} }\ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{cat}\NormalTok{(}\StringTok{"Note: La rotation Varimax suppose des facteurs non corr√©l√©s. La matrice Phi n\textquotesingle{}est pas informative.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  \}}

\NormalTok{  resd }\OtherTok{=} \FunctionTok{residuals}\NormalTok{(efa\_model, }\AttributeTok{diag =} \ConstantTok{FALSE}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
  \FunctionTok{print}\NormalTok{(resd)}
  \CommentTok{\# Enregistre l\textquotesingle{}histogramme des r√©sidus dans un fichier PNG.}
  \FunctionTok{png}\NormalTok{(}\StringTok{"Images/residuals.png"}\NormalTok{, }\AttributeTok{width =} \DecValTok{2000}\NormalTok{, }\AttributeTok{height =} \DecValTok{1500}\NormalTok{, }\AttributeTok{res =} \DecValTok{300}\NormalTok{, }\AttributeTok{units =} \StringTok{"px"}\NormalTok{)}
  \FunctionTok{hist}\NormalTok{(resd, }
       \AttributeTok{col =} \StringTok{"red"}\NormalTok{, }
       \AttributeTok{main =} \StringTok{"R√©sidus"}\NormalTok{,}
       \AttributeTok{xlab =} \StringTok{"Valeurs des r√©sidus"}\NormalTok{,}
       \AttributeTok{cex.main =} \DecValTok{2}\NormalTok{,}
       \AttributeTok{cex.lab =} \FloatTok{1.5}\NormalTok{,}
       \AttributeTok{cex.axis =} \FloatTok{1.5}
\NormalTok{  )}
  \FunctionTok{dev.off}\NormalTok{()}
  \FunctionTok{hist}\NormalTok{(resd, }\AttributeTok{col =} \StringTok{"red"}\NormalTok{, }\AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\StringTok{"Residuals"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Residuals"}\NormalTok{))}
  
  \CommentTok{\# Cr√©e et enregistre le diagramme des facteurs dans un fichier PDF.}
  \FunctionTok{pdf}\NormalTok{(}\StringTok{"Images/fadiagram.pdf"}\NormalTok{, }\AttributeTok{height=}\DecValTok{10}\NormalTok{, }\AttributeTok{width=}\DecValTok{20}\NormalTok{)}
  \FunctionTok{fa.diagram}\NormalTok{(efa\_model,}
              \AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{digits =} \DecValTok{2}\NormalTok{,}
              \AttributeTok{main =} \StringTok{""}\NormalTok{,}
              \AttributeTok{cut =} \FloatTok{0.20}
\NormalTok{  )}
  \FunctionTok{dev.off}\NormalTok{()}
  \FunctionTok{fa.diagram}\NormalTok{(efa\_model,}
              \AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{,}
              \AttributeTok{digits =} \DecValTok{2}\NormalTok{,}
              \AttributeTok{main =} \StringTok{""}\NormalTok{,}
              \AttributeTok{cut =} \FloatTok{0.20}
\NormalTok{  )}

  \CommentTok{\# Retourne l\textquotesingle{}objet mod√®le complet.}
  \FunctionTok{return}\NormalTok{(efa\_model)}
\NormalTok{\}}

\CommentTok{\# D√©finit le nombre de facteurs choisis pour l\textquotesingle{}analyse.}
\NormalTok{n\_factors\_chosen }\OtherTok{\textless{}{-}} \DecValTok{2}

\FunctionTok{cat}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{==\textgreater{} Nombre de facteurs CHOISI :"}\NormalTok{, n\_factors\_chosen, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ==> Nombre de facteurs CHOISI : 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Calcule la matrice de corr√©lations polychoriques √† partir des donn√©es.}
\NormalTok{poly\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{auto.correlate}\NormalTok{(df\_items2)}

\CommentTok{\# Ex√©cute la fonction d\textquotesingle{}AFE avec les param√®tres choisis et stocke le r√©sultat.}
\NormalTok{efa\_model }\OtherTok{\textless{}{-}} \FunctionTok{perform\_efa}\NormalTok{(poly\_matrix, df\_items2, }\FunctionTok{nrow}\NormalTok{(df\_items2), n\_factors\_chosen)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R√©sultats de l'AFE :
## Factor Analysis using method =  pa
## Call: fa(r = poly_matrix, nfactors = n_factors, n.obs = n_obs, rotate = "varimax", 
##     residuals = T, SMC = T, warnings = T, fm = "pa")
## Standardized loadings (pattern matrix) based upon correlation matrix
##                 item   PA1   PA2   h2   u2 com
## sens              10  0.80       0.64 0.36 1.0
## apprend            4  0.76       0.59 0.41 1.0
## varie              5  0.73       0.57 0.43 1.2
## reconnu            7  0.71       0.53 0.47 1.1
## perspective        9  0.69       0.48 0.52 1.0
## suggestion        11  0.65       0.46 0.54 1.2
## cooperation        6  0.59 -0.32 0.45 0.55 1.5
## ambiance          12  0.59       0.42 0.58 1.4
## pression           3        0.74 0.57 0.43 1.1
## trop_vite          2        0.73 0.55 0.45 1.0
## taches_diff       13        0.73 0.54 0.46 1.0
## depasse_horaire    1        0.59 0.38 0.62 1.2
## psy                8 -0.30  0.55 0.39 0.61 1.5
## 
##                        PA1  PA2
## SS loadings           4.01 2.57
## Proportion Var        0.31 0.20
## Cumulative Var        0.31 0.51
## Proportion Explained  0.61 0.39
## Cumulative Proportion 0.61 1.00
## 
## Mean item complexity =  1.2
## Test of the hypothesis that 2 factors are sufficient.
## 
## df null model =  78  with the objective function =  5.7 with Chi Square =  288741.6
## df of  the model are 53  and the objective function was  0.44 
## 
## The root mean square of the residuals (RMSR) is  0.04 
## The df corrected root mean square of the residuals is  0.05 
## 
## The harmonic n.obs is  50652 with the empirical chi square  10928.92  with prob <  0 
## The total n.obs was  50652  with Likelihood Chi Square =  22171.51  with prob <  0 
## 
## Tucker Lewis Index of factoring reliability =  0.887
## RMSEA index =  0.091  and the 90 % confidence intervals are  0.09 0.092
## BIC =  21597.38
## Fit based upon off diagonal values = 0.99
## Measures of factor score adequacy             
##                                                    PA1  PA2
## Correlation of (regression) scores with factors   0.94 0.91
## Multiple R square of scores with factors          0.89 0.83
## Minimum correlation of possible factor scores     0.79 0.67
## 
## Corr√©lations entre les facteurs (Phi matrix):
## Note: La rotation Varimax suppose des facteurs non corr√©l√©s. La matrice Phi n'est pas informative.
##                 dpss_ trp_v prssn apprn varie cprtn recnn psy   prspc sens 
## depasse_horaire    NA                                                      
## trop_vite        0.05    NA                                                
## pression         0.00  0.00    NA                                          
## apprend         -0.03 -0.05 -0.02    NA                                    
## varie           -0.01 -0.04 -0.04  0.15    NA                              
## cooperation     -0.04  0.02  0.02  0.02  0.00    NA                        
## reconnu          0.03  0.03  0.02 -0.06 -0.05  0.03    NA                  
## psy             -0.02 -0.04  0.03  0.03  0.03  0.02 -0.05    NA            
## perspective      0.01  0.02 -0.01  0.01 -0.05 -0.02  0.04 -0.03    NA      
## sens             0.00 -0.03  0.00  0.02  0.02 -0.06 -0.04  0.04  0.03    NA
## suggestion       0.04  0.01  0.01 -0.09 -0.05  0.00  0.05 -0.02  0.00  0.04
## ambiance         0.00  0.03  0.04 -0.06 -0.05  0.08  0.04 -0.03 -0.03 -0.01
## taches_diff     -0.03  0.03  0.02 -0.02  0.00  0.01  0.03 -0.01  0.00 -0.03
##                 sggst
## depasse_horaire      
## trop_vite            
## pression             
## apprend              
## varie                
## cooperation          
## reconnu              
## psy                  
## perspective          
## sens                 
## suggestion         NA
## ambiance         0.05
## taches_diff      0.02
##             ambnc tchs_
## ambiance       NA      
## taches_diff  0.02    NA
\end{verbatim}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-19-1.pdf}
\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-19-2.pdf}

\section{Interpr√©tation des facteurs et √©valuation de la
fiabilit√©}\label{interpruxe9tation-des-facteurs-et-uxe9valuation-de-la-fiabilituxe9}

Ce bloc de code identifie les items qui composent chaque facteur, en se
basant sur les saturations (loadings), et calcule l'alpha de Cronbach
pour √©valuer la coh√©rence interne de chaque facteur.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{interpret\_and\_reliability }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(efa\_model, df\_input) \{}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"NOTE : Les listes d\textquotesingle{}items ci{-}dessous sont bas√©es sur l\textquotesingle{}assignation unique de chaque item}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"au facteur o√π il a le chargement le plus √©lev√© (en valeur absolue \textgreater{}= 0.3).}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}

  \CommentTok{\# Extraire les loadings}
\NormalTok{  loadings }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{unclass}\NormalTok{(efa\_model}\SpecialCharTok{$}\NormalTok{loadings))}

  \CommentTok{\# Initialisation}
\NormalTok{  factor\_items\_list }\OtherTok{\textless{}{-}} \FunctionTok{vector}\NormalTok{(}\StringTok{"list"}\NormalTok{, }\FunctionTok{ncol}\NormalTok{(loadings))}
  \FunctionTok{names}\NormalTok{(factor\_items\_list) }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(}\StringTok{"PA"}\NormalTok{, }\DecValTok{1}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(loadings))}

  \CommentTok{\# Assignation unique : chaque item au facteur de son loading le plus √©lev√© (valeur absolue)}
  \ControlFlowTok{for}\NormalTok{ (item\_name }\ControlFlowTok{in} \FunctionTok{rownames}\NormalTok{(loadings)) \{}
\NormalTok{    abs\_loadings }\OtherTok{\textless{}{-}} \FunctionTok{abs}\NormalTok{(loadings[item\_name, ])}
\NormalTok{    max\_idx }\OtherTok{\textless{}{-}} \FunctionTok{which.max}\NormalTok{(abs\_loadings)}
    \ControlFlowTok{if}\NormalTok{ (abs\_loadings[max\_idx] }\SpecialCharTok{\textgreater{}=} \FloatTok{0.3}\NormalTok{) \{}
\NormalTok{      factor\_items\_list[[max\_idx]] }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(factor\_items\_list[[max\_idx]], item\_name)}
\NormalTok{    \}}
\NormalTok{  \}}

  \CommentTok{\# Affichage des items par facteur avec tri par magnitude du loading}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(factor\_items\_list)) \{}
\NormalTok{    items }\OtherTok{\textless{}{-}}\NormalTok{ factor\_items\_list[[i]]}
    \FunctionTok{cat}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{Items assign√©s √† Facteur "}\NormalTok{, i, }\StringTok{":}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(items) }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) \{}
\NormalTok{      load\_vals }\OtherTok{\textless{}{-}}\NormalTok{ loadings[items, i]}
\NormalTok{      sorted\_idx }\OtherTok{\textless{}{-}} \FunctionTok{order}\NormalTok{(}\FunctionTok{abs}\NormalTok{(load\_vals), }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{      sorted\_items }\OtherTok{\textless{}{-}} \FunctionTok{paste0}\NormalTok{(items, }\StringTok{" ("}\NormalTok{, }\FunctionTok{round}\NormalTok{(load\_vals, }\DecValTok{3}\NormalTok{), }\StringTok{")"}\NormalTok{)}
      \FunctionTok{print}\NormalTok{(sorted\_items[sorted\_idx])}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
      \FunctionTok{cat}\NormalTok{(}\StringTok{"Aucun item assign√©.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{    \}}
\NormalTok{  \}}

  \CommentTok{\# Calcul de la fiabilit√© (alpha de Cronbach)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{{-}{-}{-} Calcul de la fiabilit√© (Alpha de Cronbach) pour chaque facteur {-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Note : L\textquotesingle{}Alpha de Cronbach est calcul√© √† partir de la matrice de corr√©lations polychoriques, ce qui est plus appropri√© pour les donn√©es ordinales.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{  reliability\_results }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{length}\NormalTok{(factor\_items\_list)) \{}
\NormalTok{    items }\OtherTok{\textless{}{-}}\NormalTok{ factor\_items\_list[[i]]}
    \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(items) }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{) \{}
      
      \CommentTok{\# Calcule la matrice de corr√©lations polychoriques pour les items du facteur}
\NormalTok{      polychoric\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{auto.correlate}\NormalTok{(df\_input[, items, }\AttributeTok{drop =} \ConstantTok{FALSE}\NormalTok{])}
      
      \CommentTok{\# Calcule l\textquotesingle{}alpha de Cronbach √† partir de la matrice polychorique}
\NormalTok{      alpha\_result }\OtherTok{\textless{}{-}}\NormalTok{ psych}\SpecialCharTok{::}\FunctionTok{alpha}\NormalTok{(polychoric\_matrix, }\AttributeTok{check.keys =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{      alpha\_val }\OtherTok{\textless{}{-}}\NormalTok{ alpha\_result}\SpecialCharTok{$}\NormalTok{total}\SpecialCharTok{$}\NormalTok{std.alpha}
      
\NormalTok{      reliability\_results[[}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Factor"}\NormalTok{, i)]] }\OtherTok{\textless{}{-}}\NormalTok{ alpha\_val}
      \FunctionTok{cat}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Facteur "}\NormalTok{, i, }\StringTok{" ("}\NormalTok{, }\FunctionTok{length}\NormalTok{(items), }\StringTok{" items) Alpha : "}\NormalTok{, }\FunctionTok{round}\NormalTok{(alpha\_val, }\DecValTok{3}\NormalTok{), }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\NormalTok{    \} }\ControlFlowTok{else} \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(items) }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) \{}
\NormalTok{      reliability\_results[[}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Factor"}\NormalTok{, i)]] }\OtherTok{\textless{}{-}} \ConstantTok{NA}
      \FunctionTok{cat}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Facteur "}\NormalTok{, i, }\StringTok{" (1 item) : Alpha non applicable.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\NormalTok{    \} }\ControlFlowTok{else}\NormalTok{ \{}
\NormalTok{      reliability\_results[[}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Factor"}\NormalTok{, i)]] }\OtherTok{\textless{}{-}} \ConstantTok{NA}
      \FunctionTok{cat}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Facteur "}\NormalTok{, i, }\StringTok{" (0 items) : Aucun item assign√© pour le calcul de fiabilit√©.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{))}
\NormalTok{    \}}
\NormalTok{  \}}

  \FunctionTok{cat}\NormalTok{(}\StringTok{"{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Un alpha \textgreater{} 0.7 est g√©n√©ralement consid√©r√© comme acceptable/bon.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Un alpha entre 0.6 et 0.7 est marginal/discutable.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
  \FunctionTok{cat}\NormalTok{(}\StringTok{"Un alpha \textless{} 0.6 est g√©n√©ralement consid√©r√© comme faible.}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}

  \FunctionTok{return}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\AttributeTok{factor\_items =}\NormalTok{ factor\_items\_list, }\AttributeTok{reliability =}\NormalTok{ reliability\_results))}
\NormalTok{\}}

\NormalTok{interpretation }\OtherTok{\textless{}{-}} \FunctionTok{interpret\_and\_reliability}\NormalTok{(efa\_model, df\_items2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## NOTE : Les listes d'items ci-dessous sont bas√©es sur l'assignation unique de chaque item
## au facteur o√π il a le chargement le plus √©lev√© (en valeur absolue >= 0.3).
## 
## Items assign√©s √† Facteur 1:
## [1] "sens (0.797)"        "apprend (0.759)"     "varie (0.726)"      
## [4] "reconnu (0.706)"     "perspective (0.691)" "suggestion (0.649)" 
## [7] "cooperation (0.591)" "ambiance (0.589)"   
## 
## Items assign√©s √† Facteur 2:
## [1] "pression (0.741)"        "trop_vite (0.733)"      
## [3] "taches_diff (0.728)"     "depasse_horaire (0.586)"
## [5] "psy (0.551)"            
## 
## --- Calcul de la fiabilit√© (Alpha de Cronbach) pour chaque facteur ---
## Note : L'Alpha de Cronbach est calcul√© √† partir de la matrice de corr√©lations polychoriques, ce qui est plus appropri√© pour les donn√©es ordinales.
## Facteur 1 (8 items) Alpha : 0.881
## Facteur 2 (5 items) Alpha : 0.804
## -----------------------------------------------------------
## Un alpha > 0.7 est g√©n√©ralement consid√©r√© comme acceptable/bon.
## Un alpha entre 0.6 et 0.7 est marginal/discutable.
## Un alpha < 0.6 est g√©n√©ralement consid√©r√© comme faible.
\end{verbatim}

\section{Visualisation des variables sur les
facteurs}\label{visualisation-des-variables-sur-les-facteurs}

Ce code g√©n√®re un graphique de dispersion des variables dans l'espace
des facteurs 1 et 2, ce qui facilite l'interpr√©tation des facteurs en
montrant visuellement quels items contribuent le plus √† chaque facteur,
et compare avec la solution sans rotation.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{efa\_unrot }\OtherTok{\textless{}{-}} \FunctionTok{fa}\NormalTok{(}\AttributeTok{r =}\NormalTok{ poly\_matrix, }\AttributeTok{nfactors =}\NormalTok{ n\_factors\_chosen, }\AttributeTok{rotate =} \StringTok{"none"}\NormalTok{, }\AttributeTok{fm =} \StringTok{"pa"}\NormalTok{)}
\NormalTok{efa\_rotobl }\OtherTok{\textless{}{-}} \FunctionTok{fa}\NormalTok{(}\AttributeTok{r =}\NormalTok{ poly\_matrix, }\AttributeTok{nfactors =}\NormalTok{ n\_factors\_chosen, }\AttributeTok{rotate =} \StringTok{"promax"}\NormalTok{, }\AttributeTok{fm =} \StringTok{"pa"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required namespace: GPArotation
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-} Graphique de la solution non{-}rotat√©e {-}{-}{-}}
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(efa\_unrot) }\SpecialCharTok{\&\&} \SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(efa\_unrot}\SpecialCharTok{$}\NormalTok{loadings)) \{}
  \FunctionTok{factor.plot}\NormalTok{(efa\_unrot, }
              \AttributeTok{labels =} \FunctionTok{rownames}\NormalTok{(efa\_unrot}\SpecialCharTok{$}\NormalTok{loadings), }
              \AttributeTok{choose =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{),}
              \AttributeTok{main =} \StringTok{"Solution non{-}rotat√©e"}\NormalTok{,}
              \AttributeTok{xlab =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"PA1 ("}\NormalTok{, }\FunctionTok{round}\NormalTok{(efa\_unrot}\SpecialCharTok{$}\NormalTok{Vaccounted[}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{] }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{), }\StringTok{" \%)"}\NormalTok{),}
              \AttributeTok{ylab =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"PA2 ("}\NormalTok{, }\FunctionTok{round}\NormalTok{(efa\_unrot}\SpecialCharTok{$}\NormalTok{Vaccounted[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{] }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{), }\StringTok{" \%)"}\NormalTok{)}
\NormalTok{  )}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-21-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# {-}{-}{-} Graphique de la solution rotat√©e Varimax {-}{-}{-}}
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(efa\_model) }\SpecialCharTok{\&\&} \SpecialCharTok{!}\FunctionTok{is.null}\NormalTok{(efa\_model}\SpecialCharTok{$}\NormalTok{loadings)) \{}
  \FunctionTok{factor.plot}\NormalTok{(efa\_model, }
              \AttributeTok{labels =} \FunctionTok{rownames}\NormalTok{(efa\_model}\SpecialCharTok{$}\NormalTok{loadings), }
              \AttributeTok{choose =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{),}
              \AttributeTok{main =} \StringTok{"Rotation oblique (varimax)"}\NormalTok{,}
              \AttributeTok{xlab =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"PA1 ("}\NormalTok{, }\FunctionTok{round}\NormalTok{(efa\_model}\SpecialCharTok{$}\NormalTok{Vaccounted[}\DecValTok{2}\NormalTok{, }\DecValTok{1}\NormalTok{] }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{), }\StringTok{" \%)"}\NormalTok{),}
              \AttributeTok{ylab =} \FunctionTok{paste0}\NormalTok{(}\StringTok{"PA2 ("}\NormalTok{, }\FunctionTok{round}\NormalTok{(efa\_model}\SpecialCharTok{$}\NormalTok{Vaccounted[}\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{] }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{), }\StringTok{" \%)"}\NormalTok{)}
\NormalTok{  )}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\includegraphics{Objectif-1_files/figure-latex/unnamed-chunk-21-2.pdf}

\end{document}
